(function(a){a.fn.pxuPhotoset=function(b){var c={highRes:true,rounded:"corners",borderRadius:"5px",exif:true,gutter:"10px",photoset:".photo-slideshow",photoWrap:".photo-data",photo:".photo"};var b=a.extend(c,b);return this.each(function(){var c=a(this);c.imagesLoaded(function(){var d=c.data("layout");var e=JSON.stringify(d).split("");var f=[];for(var g=1;g<e.length+1;g++){f.push(g)}var h=[];for(g=0;g<f.length;++g){var i=0;for(p=0;p<g+1;++p){increment=parseInt(e[p]);i+=increment}var j=parseInt(e[g]);h[g]=Array(f[g],j,i)}for(var g=0;g<f.length;g++){var k;if(h[g-1]===undefined){k=0}else{k=h[g-1][2]}c.find(b.photoWrap).slice(k,h[g][2]).addClass("count-"+h[g][1]).wrapAll('<div class="row clearit" />')}a(this).find(".row").css("margin-bottom",b.gutter);a(this).find(b.photoWrap+":not(:first-child) "+b.photo+" img").css("margin-left",b.gutter);Array.min=function(a){return Math.min.apply(Math,a)};c.find(".count-1 img").each(function(){var b=a(this).height();a(this).parents(".row").height(b)});var l=a(this).find(".count-2 img").map(function(){return a(this).height();}).get();var m=Array.min(l);var n=a(this).find(".count-3 img").map(function(){return a(this).height();}).get();var o=Array.min(n);c.find(".count-2").parents(".row").css({height:m});c.find(".count-2").children(b.photo).css({height:m});c.find(".count-3").parents(".row").css({height:o});c.find(".count-3").children(b.photo).css({height:o});if(b.exif==true){c.find(b.photoWrap).each(function(){var b=a(this).find("img");exifCamera=b.data("camera")||"-";exifISO=b.data("iso")||"-";exifAperture=b.data("aperture")||"-";exifExposure=b.data("exposure")||"-";exifFocal=b.data("focal")||"-";a(this).find(".info").append('<div class="exif"><table><tr><td colspan="2"><span class="label">Camera</span><br>'+exifCamera+'</td></tr><tr><td><span class="label">ISO</span><br>'+exifISO+'</td><td><span class="label">Aperture</span><br>'+exifAperture+'</td></tr><tr><td><span class="label">Exposure</span><br>'+exifExposure+'</td><td><span class="label">Focal Length</span><br>'+exifFocal+'</td></tr></table><span class="arrow-down"></span></div>');c.find("span.info").css("display","block")})}if(b.highRes==true){c.find(b.photoWrap).each(function(){var b=a(this).find("img");bigOne=b.data("highres");b.attr("src",bigOne)})}if(b.rounded=="corners"){var q=c.find(".row"),f=c.find(".row").size(),r=c.find(".row").size()-1;if(f==1){q.find(b.photoWrap+":first-child "+b.photo).css({borderRadius:b.borderRadius+" 0 0 "+b.borderRadius});q.find(b.photoWrap+":last-child "+b.photo).css({borderRadius:"0 "+b.borderRadius+" "+b.borderRadius+" 0"})}else{for(var g=0;g<q.length;g++){if(g==0){count=q.eq(g).find(b.photo).size();if(count==1){q.eq(g).find(b.photo).css({borderRadius:b.borderRadius+" "+b.borderRadius+" 0 0"})}else if(count==2||count==3){q.eq(g).find(b.photoWrap+":first-child "+b.photo).css({borderRadius:b.borderRadius+" 0 0 0"});q.eq(g).find(b.photoWrap+":last-child "+b.photo).css({borderRadius:"0 "+b.borderRadius+" 0 0"})}}if(g==r){count=q.eq(g).find(b.photo).size();if(count==1){q.eq(g).find(b.photo).css({borderRadius:"0 0 "+b.borderRadius+" "+b.borderRadius})}else if(count==2||count==3){q.eq(g).find(b.photoWrap+":first-child "+b.photo).css({borderRadius:"0 0 0 "+b.borderRadius});q.eq(g).find(b.photoWrap+":last-child "+b.photo).css({borderRadius:"0 0 "+b.borderRadius+" 0"})}}}}}if(b.rounded=="all"){c.find(b.photo).css({borderRadius:b.borderRadius})}if(b.rounded==false){c.find(b.photo).css({borderRadius:0})}c.addClass("processed")});a(b.photoWrap).live("mouseenter",function(){a(this).find(".icons").css("visibility","visible")}).live("mouseleave",function(){a(this).find(".icons").css("visibility","hidden")});a("span.info").live("mouseenter",function(){var b=a(this);exifData=b.children(".exif");exifData.css("display","block").stop(true,false).animate({opacity:1},200)});a("span.info").live("mouseleave",function(){var b=a(this);exifData=b.children(".exif");exifData.stop(true,false).animate({opacity:0},200,function(){a(this).css("display","none")})})})}})(jQuery)