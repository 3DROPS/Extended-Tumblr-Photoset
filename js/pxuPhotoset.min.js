(function(a){a.fn.pxuPhotoset=function(b){var c={highRes:true,rounded:"corners",exif:true,gutter:"10px",photoset:".photo-slideshow",photoWrap:".photo-data",photo:".photo"};var b=a.extend(c,b);return this.each(function(){var c=a(this);c.imagesLoaded(function(){var d=c.attr("data-layout").split("");var e=[];for(var f=1;f<d.length+1;f++){e.push(f)}var g=[];for(f=0;f<e.length;++f){var h=0;for(p=0;p<f+1;++p){increment=parseInt(d[p]);h+=increment}var i=parseInt(d[f]);g[f]=Array(e[f],i,h)}for(var f=0;f<e.length;f++){var j;if(g[f-1]===undefined){j=0}else{j=g[f-1][2]}c.find(b.photoWrap).slice(j,g[f][2]).addClass("count-"+g[f][1]).wrapAll('<div class="row clearit" />')}a(this).find(".row").css("margin-bottom",b.gutter);a(this).find(b.photoWrap+":not(:first-child) "+b.photo+" img").css("margin-left",b.gutter);Array.min=function(a){return Math.min.apply(Math,a)};c.find(".count-1 img").each(function(){var b=a(this).height();a(this).parents(".row").height(b)});var k=a(this).find(".count-2 img").map(function(){return a(this).height();}).get();var l=Array.min(k);var m=a(this).find(".count-3 img").map(function(){return a(this).height();}).get();var n=Array.min(m);c.find(".count-2").parents(".row").css({height:l});c.find(".count-2").children(b.photo).css({height:l});c.find(".count-3").parents(".row").css({height:n});c.find(".count-3").children(b.photo).css({height:n});if(b.exif==true){c.find(b.photoWrap).each(function(){var b=a(this).find("img");exifCamera=b.attr("data-camera")||"-";exifISO=b.attr("data-iso")||"-";exifAperture=b.attr("data-aperture")||"-";exifExposure=b.attr("data-exposure")||"-";exifFocal=b.attr("data-focal")||"-";a(this).find(".info").append('<div class="exif"><table><tr><td colspan="2"><span class="label">Camera</span><br>'+exifCamera+'</td></tr><tr><td><span class="label">ISO</span><br>'+exifISO+'</td><td><span class="label">Aperture</span><br>'+exifAperture+'</td></tr><tr><td><span class="label">Exposure</span><br>'+exifExposure+'</td><td><span class="label">Focal Length</span><br>'+exifFocal+'</td></tr></table><span class="arrow-down"></span></div>');c.find("span.info").css("display","block")})}if(b.highRes==true){c.find(b.photoWrap).each(function(){var b=a(this).find("img");bigOne=b.attr("data-highres");b.attr("src",bigOne)})}if(b.rounded=="corners"){var o=c.find(".row"),e=c.find(".row").size(),q=c.find(".row").size()-1;if(e==1){o.find(b.photoWrap+":first-child "+b.photo).css({borderRadius:"5px 0 0 5px"});o.find(b.photoWrap+":last-child "+b.photo).css({borderRadius:"0 5px 5px 0"})}else{for(var f=0;f<o.length;f++){if(f==0){count=o.eq(f).find(b.photo).size();if(count==1){o.eq(f).find(b.photo).css({borderRadius:"5px 5px 0 0"})}else if(count==2||count==3){o.eq(f).find(b.photo+":first-child").css({borderRadius:"5px 0 0 0"});o.eq(f).find(b.photo+":last-child").css({borderRadius:"0 5px 0 0"})}}if(f==q){count=o.eq(f).find(b.photo).size();if(count==1){o.eq(f).find(b.photo).css({borderRadius:"0 0 5px 5px"})}else if(count==2||count==3){o.eq(f).find(b.photoWrap+":first-child "+b.photo).css({borderRadius:"0 0 0 5px"});o.eq(f).find(b.photoWrap+":last-child "+b.photo).css({borderRadius:"0 0 5px 0"})}}}}}if(b.rounded=="all"){c.find(b.photo).css({borderRadius:"5px"})}if(b.rounded==false){c.find(b.photo).css({borderRadius:0})}c.addClass("processed")});a(b.photoWrap).live("mouseenter",function(){a(this).find(".icons").stop(true,false).animate({opacity:1},200)}).live("mouseleave",function(){a(this).find(".icons").stop(true,false).animate({opacity:0},200)});a("span.info").live("mouseenter",function(){var b=a(this);exifData=b.children(".exif");exifData.css("display","block").stop(true,false).animate({opacity:1},200)});a("span.info").live("mouseleave",function(){var b=a(this);exifData=b.children(".exif");exifData.stop(true,false).animate({opacity:0},200,function(){a(this).css("display","none")})})})}})(jQuery)